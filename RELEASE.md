# AT&T Enhanced WebRTC JS SDK Release Notes

This SDK includes the following components:

* JavaScript library - a client library to access the AT&T Enhanced WebRTC API.
* Node.js sample app - a Web app demonstrating the features of the JavaScript library and managing app configuration elements such as App Key and App Secret. **Please refer to `node-sample/RELEASE.md` for sample app-specific notes**.
* Developer Hosted Server (DHS) library - a Node.js library for generating OAuth access tokens and E911 IDs. **Please refer to  `node-sample/lib/RELEASE.md` for DHS library-specific notes**.

## Features of the JavaScript library

The following features and functionality are available in the current SDK release for all three supported calling types
 (AT&T Mobile Number, Virtual Number, and Account ID):

### Chrome v43

*	**Basic audio and video call management** – make, receive, answer, end, mute, unmute, hold, resume, cancel, and reject calls.
*	**Basic audio and video conferencing** – create a conference, add and remove participants, hold, resume, mute, unmute, and end conference.
  *	Supports dialing out to add participants.
*	**Advanced call management** – move, transfer, add a second call, switch between two calls, upgrade, downgrade, and reject upgrade requests.
  *	Audio and video calls can be moved Web-to-Web
  *	Calls can be moved from the Web to an AT&T mobile phone

### Firefox

  *	**No SDK features are tested with Firefox.**

### Upcoming features

The following features will be added soon:

*	Firefox browser support
*	DTMF (dialing) tones

# v1.0.0-rc.22

June 12, 2015

* **Fix:** Improved documentation on number format when dialing and adding participants to a conference.
* **Fix:** Wrong video media type shown when making calls from the browser to mobile devices.
* **New:** New method `Phone.rejectModification`. This method allows the user to reject media modification requests such as upgrade requests generated by the `Phone.upgrade` method or downgrade requests generated by the `Phone.downgrade` method.
* **New:** Automatically reject a call modification in the sample app if it’s not accepted after 5 seconds.

## Known Issues

* Moving a Mobile Number call from a browser to a mobile device results in a downgrade request. 
* Upgrading after a downgrade doesn't work due to a known issue with the underlying platform. 
* Moving a video call from MOBILE_NUMBER to MOBILE_NUMBER fails when in a call with another MOBILE_NUMBER. 
* Moving a video call from one browser to another browser fails when in a call with a provisioned mobile device. 
* Transfer from a browser to a provisioned non-VoLTE mobile device fails for various reasons. 
* Transfer from a provisioned mobile device to an Account ID fails with `External Server request timeout`. 
* Downgrade fails after a successful Call Move. 
  * For example: Alice is logged in with two browsers, Bob is logged in with a browser, and both are currently in a video call. If Alice successfully moves her call from Browser A to Browser B and Bob tries to downgrade the video call, the action fails with error `SVC0001:A service error has occurred. Error code is Parameter 'sdp' has invalid format.,Variables=Parameter 'sdp' has invalid format.`
* When moving a call using `Phone.move`, the operation is successful but the error message `Unrecognized event state: move-terminated` appears in the browser console. 
* When downgrading a call after successfully resuming it, the `Phone.downgrade` method fails with the error message: `SVC0001:A service error has occurred. Error code is Parameter 'sdp' has invalid format.,Variables=Parameter 'sdp' has invalid format`. 
* When holding a call after successfully downgrading it, the `Phone.hold` method fails with the error message: `SVC0001:A service error has occurred. Error code is Parameter 'sdp' has invalid format.,Variables=Parameter 'sdp' has invalid format`. 
* Downgrading a muted call results in unmuting the call on both sides. 
* A recipient can resume a call that has been held by another participant. 
* While in a video call, transfer to a non-provisioned mobile device target fails with the error: `There was an error transferring the call. Forbidden` 
* Media streaming may not function correctly unless IPv6 is disabled. The default behavior is to use IPv4, so explicitly disabling IPv6 is not required. 
* When a user starts a conference and invites a mobile device, and the mobile device user rejects the invitation, no invitation rejected event occurs. 
* While using Chrome, adding a mobile device as a participant to a conference hosted by a Mobile Number results in one-way audio with the notification, `Media conference forbidden for this recipient`. 
* When in a call between a Mobile Number user using Firefox and a Mobile Device user, if the Mobile Number user tries to move the call to a mobile phone, the following error may occur:
  `Could not negotiate answer SDP; cause = SDP_PARSE_FAILED | SDP Parsing Error: c= connection line not specified for
   every media level, validation failed.` 
* Scenarios that would result in a user having one call and one conference are not supported, and should generate an error. 
* When initially loading the Sample app (`https://127.0.0.1:9001`) the following error will appear:
  `NET::ERR_CERT_AUTHORITY_INVALID`. 
  * Workaround: Add a security exception by clicking `Advanced` and then clicking `Proceed to 127.0.0.1 (unsafe)`
* When using Firefox, removing a participant from a conference could result in the error, `ReferenceError: event is not defined sample.js:593`.
* When using Firefox, calling a Mobile Number could result in the following errors:
  * `Renegotiation of session description is not currently supported. See Bug 840728 for status.`
    Despite this error, the call is established and the users can hear each other.
  * `Could not negotiate answer SDP; cause = SDP_PARSE_FAILED | SDP Parsing Error: Warning: Unrecognized attribute
    (ice-mismatch) | SDP Parsing Error: c= connection line not specified for every media level, validation failed.s`.
    When this error occurs, the call is established but the users cannot hear each other.
* Canceling to give consent to a Mobile Number results in redirecting the user to an “Access Denied” error page. 
* Resuming a video conference from the participant side results in no video on both host and participant sides. 
* When moving a call to another device, a background call will auto resume. 
* Switching to the background call on Chrome for Windows results in no media in the call. 
* Adding a non-provisioned mobile device as a participant to a conference results in one-way audio, with the notification
  `Media conference forbidden for this recipient`. 
* When the host is a Virtual Number, adding an Account ID participant to a conference fails with the message: `User Not Found`. 
* When ending a conference, the list of participants is not cleared. 
* When successfully completing `phone.move`, the `call:move-terminated` event is not fired. 
* Adding multiple participants at once using `Phone.addParticipants` method fails with the error, `SVC8501:MediaConference ongoing update participant operation.,Variables=`. 
 * Workaround: use `Phone.addParticipants` with a single participant ID (Mobile Number, Account ID, Virtual Number) and wait for that participant to successfully join (with the event `conference:invitation-accepted`), then invite the next participant.
* When a participant leaves a conference using the `endConference` method, the platform does not generate the necessary event to inform the host.
* When a Mobile Number user rejects an invitation for a conference, sometimes the event `conference:ended` is not published due to a bug at the platform level.
* When adding a participant to a conference, the error, `The requested conference ID <id> was not found` may appear.
* Video switching between participants is sometimes inconsistent. 
 *Workaround: Turn off your microphone when the other participant speaks to switch the video to the speaking participant.

## Notes

* Establishing calls with Firefox is notably slower than doing so with Chrome.

## Tested Environments

* Chrome Version 43.0 for OSX v10.8.5 and Windows 8

**_The SDK may also work for other operating systems and browsers but not tested or supported._**


# Changelog

## v1.0.0-rc.21

June 5, 2015

* **Fix:** One-way audio on non-provisioned VoLTE handset following call transfer.

## v1.0.0-rc.20

June 2, 2015

* **New:** Upgrade an audio call to video call.

## v1.0.0-rc.19

May 29, 2015

* **Fix:** The returned `getCallerInfo()` object is improperly formatted for Account ID users.
* **Fix:** Sample app shows a username encoded as a number for Account ID users.
* **Fix:** Intermittent `ice-ufrag` error when answering a call.

## v1.0.0-rc.18

May 22, 2015

* **Fix:** Mobile Number users with VoLTE devices are unable to answer incoming calls. The call keeps ringing and eventually goes to voicemail.

## v1.0.0-rc.17

May 15, 2015

* **Fix:** Setting global logging level to trace generates a JavaScript error while making a call.
* **Fix:** Error during transferring a call.
* **Fix:** Video call quality on a call holder’s side is extremely poor following resume from hold.
* **Fix:** Transfer to a provisioned phone fails when in a video call with non-provisioned phone.
* **Fix:** Transferring a call fails with an HTTP error code `409` when an Account ID user transfers to a mobile device.


## v1.0.0-rc.16

April 16, 2015

* **New:** New `ATT.logManager` features:
  * `getLogLevels`: Method to get all defined log levels for the log manager.
  * `getCurrentModuleLogLevels`: Method to get the current modules with their defined log levels.
  * `getGlobalLogLevel`: Method to get the current log level for all modules.
  * `setGlobalLogLevel`: Method to set a log level for all the modules.
  * `resetLogLevels`: Method to reset log levels for all modules to their defaults.
  * `getLoggers`: Method to get the log manager's list of modules.
  * `getModuleDefaults`: Method to get the modules with defined default log levels.
  * `createCustomLogger`: Method to create a custom logger by passing a module name.
  * `deleteCustomLogger`: Method to delete a custom logger by passing a module name.
* **Changed:** Changed `ATT.logManager` feature
    * `getLogger`: Method to get the logger object by passing the module name.
* **Removed:** Removed from `ATT.logManager`
  * `addLoggerForModule`
  * `configureLogger`
  * `getLoggerByName`
  * `logLevel`
  * `loggerType`
  * `LOG_LEVEL`
  * `LOGGER_TYPE`
* **New:** New `ATT.logManager.Logger` features:
  * `isCustomType`: Returns true if a custom Logger
  * `setLogLevel`: Sets log level of Logger
  * `getLogLevel`: Gets log level of Logger
* **Removed:** Removed from `ATT.logManager.Logger`
  * `level`
  * `setLevel`
  * `setType`
  * `Type`
* **New:** Methods to manage configuration for `RTCPeerConnection`.
  * `getIceServers`: Function to get the current ICE servers that the SDK uses for creating peer connections.
  * `setIceServers`: Method to set the list of ICE servers that the SDK uses for creating peer connections.
  * `resetIceServers`: Method to reset the list of ICE servers to default list for peer connection configuration.
  * `getIceTransport`: Function to get the current ICE transport value that the SDK uses for creating peer connections.
  * `setIceTransport`: Method to set the ICE transport that the SDK uses for creating peer connections.
  * `resetIceTransport`: Method to reset the ICE transport value to the value for peer connection configuration.
  * `getIpv6`: Function to get the ipv6 value that the SDK uses for creating peer connections.
  * `setIpv6`: Method to set the ipv6 value that the SDK uses for creating peer connections.
  * `resetIpv6`: Method to reset the ipv6 to the default value for peer connection configuration.

## v1.0.0-rc.15

April 3, 2015

* **Fix:** Users cannot log in again using the same Access Token.
* **Fix:** SDK can dial a second call by putting the previous call automatically on hold.
* **Fix:** Video stream is dropped when a video call is on hold for 15 minutes or more before the call is resumed.


## v1.0.0-rc.14

March 22, 2015

* **New:** DHS functions are now available as a public module named `att-dhs`. You can use this as you would a regular node module.
* **Removed:**
 * Stand-alone node-dhs is removed. DHS functions are now available in the `att-dhs` public module. You can use these DHS functions in your own Node.js app. An illustrative example is provided in the /node-sample/ folder.
 * ATT.rtc.dhs namespace is deleted. Use the migration guide for code snippets to invoke sample app DHS routes.
 *The  ATT.rtc.configure method is no longer needed.
 * DHS routes are now in /node-sample/.
 * `restify-dhs` is optional, use this only if you want a standalone DHS.
* **Fix:** `phone.logout` method will always return after cleaning a session and call resources, if any.

## v1.0.0-rc.13

March 6, 2015

* **Fix:** Call index is the same for 2 calls in phone.getCalls().
* **New:** DHS Library: A new server-side Node.js based library to provide oAuth token and E911 ID methods.
    * This will replace a separate server for DHS.
    * The DHS-specific configuration (e.g., app key, app secret) can now be done on the sample server itself
    * Please refer to the DHS Library JSDocs and ReadMe for further information.
* **Change:** The following SDK methods are changed. **Please update your Web application accordingly.**
    * ATT.rtc.dhs.createAccessToken is now ATT.rtc.createAccessToken
    * ATT.rtc.dhs.createE911Id is now ATT.rtc.createE911Id
    * ATT.rtc.configure now has a new signature. Please refer to SDK API JSDocs for updates to this method.
* **Change:** The sample app is now launched by navigating to `https://localhost:9001`.
    * You still must add a security exception for `https://localhost:9001` to your browser.
    * Please refer to the ReadMe for more information.



## v1.0.0-rc.12

February 20, 2015

* **Fix:** Multiple Login Failed errors appear in succession, concatenating when the page is not refreshed.
* **Fix:** No audio on handset following a call move.
* **Fix:** Move call unnecessarily fires call:connected and media:established events and throws a JS exception.

* **New:** The Call-id in the event object will be a complete URI instead of parsed numbers or ID.
  * Added the new method getCallerInfo(callerUri) to parse the raw URI to the return information like callerId, protocol, domain, port, and other associated information.


## v1.0.0-rc.11

February 6, 2015

* **Fix:** The DHS and the Sample App now use the IP address `127.0.0.1` instead of the hostname `localhost` so that the developer only has to add one SSL security exception.
* **Fix:** Video camera remains on after disconnecting a call.
* **Fix:** Unable to uniquely track two calls to the same number. QC 74097.
  * Event data associated with a call/conference event now has `index` that refers to ordinal numbering of the call in the list of existing calls.
  * Public method `phone.getCalls` updated to return call `index`, `breed`, `type`, `state` and `peer`/`participants`.
* **New:** The Developer Hosted Server now uses AT&T OAuth v4.0.

## v1.0.0-rc.10

January 22, 2015

* **Fix:** the `Phone` object will publish an error event upon invalid scenarios for a second call. The second call feature only supports simple two-call scenarios, with one call in the background (inactive) and one call in the foreground (active). Scenarios that would result in the user having one call and one conference are not supported and will generate an error.
* **Fix:** `Phone.transfer` fails with error `Transfer terminated by Network` when the transfer target is an Account ID or Virtual Number user.
* **Fix:** Corrected various typos in log statements.
* **Fix:** Moving a call fails when the call is put on hold before invoking `Phone.move`.
* **Change:** Use a short user name on `Phone` events (`event.from` and `event.to`):
  * Account ID: `sip:user@domain.com` => `user`
  * Mobile Number: `sip:1234567890@domain.com` => `1234567890`
  * Virtual User: `tel:+1234567890` => `1234567890`
* **New:** The `Phone` object will publish a `session:expired` event when the library detects that the current session has expired in the server. See the documentation for details in the payload of the event.
* **New:** Method `ATT.browser.isNetworkConnected` to check for network connectivity.

## v1.0.0-rc.9

December 31, 2014

* **Enhancement:** Added 'session:expired' event to the Phone object.
* **Enhancement:** Improved call establishment time.
* **Change:** Less verbose logging.
* **Change:** Provided full user name on event data for all phone events.

## v1.0.0-rc.7

### Features

#### Chrome v39

* Basic audio and video call management – make, receive, answer, end, mute, unmute, hold, resume, cancel, and reject calls
* Basic audio and video conferencing – create a conference, add and remove participants, hold, resume, mute, unmute, and end conference
* Advanced call management – move, transfer, add a second call, and switch between two calls
* Audio and video calls can be moved browser-to-browser
* Audio calls can be moved from a browser to an AT&T mobile phone.


#### Firefox v33

* Basic audio and video call management – make, receive, answer, end, mute, unmute, hold, resume, cancel, and reject calls
* Basic audio and video conferencing – create a conference, add and remove participants, hold, resume, mute, unmute, and end conference
